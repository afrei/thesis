At this point we've made good progress towards the proof of Morley's Categoricity theorem.
It suffices to show that uncountable categoricity (for any uncountable cardinal) is equivalent to \(\omega\)-stability and lacking Vaughtian pairs.
As this property doesn't depend on the uncountable cardinality, this suffices. 

We've already shown that \(\omega\)-stability and lacking Vaughtian pairs are necessary for uncountable categoricity.
To show these conditions are also sufficient we will define a notion of ``dimension'' for elementary extensions.
\(\osmega\)-stability already tells us that we can view any two models as elementary extensions of the same prime model by Theorem %.
Because of their cardinalities, any equinumerous models will have the same dimension over this prime model.
Having the same dimension over this prime model will suffice to show that these two models are isomorphic.
This will complete the proof. 

\subsection{Strong Minimality and Vaughtian Pairs}

Now, assume we have a theory which is \omst and has no Vaughtian-pairs. 
As it is \omst it has a prime model.
By \(\omega\)-stability, that prime model has a minimal formula. 
For our proof of Morley's categoricity theorem it will be important that this minimal formula is strongly minimal, so that we can use dimension to find an isomorphism as described above. 
A theory lacking Vaughtian pairs will have the property that minimal formula are strongly minimal. 

\begin{theorem}\label{theorem_minimal_vaughtian_pair}
If \(T\) has no Vaughtian pairs and \(\phi\) is a minimal formula for \(\mcM \models T\) then \(\phi\) is strongly-minimal. 
\end{theorem}

\begin{proof}
If \(\phi\) is not strongly minimal, there is \(\mcM \prec \mcN\), \(\bar{b} \in \mcN\) and \(\psi(\bar{x}, \bar{b})\) such that \(\psi(\mcN, \bar{b})\) is infinite and co-infinite. 
We see that for every natural number \(n\), we know \(\mcN \models \E \bar{b} (\theta_{\psi, \bar{b}, n} \land \theta_{\neg \psi, \bar{b}, n})\) where \(\theta_{\psi, \bar{b},n}\) asserts there are at least \(n\) vectors \(\bar{x}\) for which \(\psi(\bar{x}, \bar{b})\) holds. 
As \(\mcM \prec \mcN\), we know that each of these formulae hold in \(\mcM\) as well. 
We can use this fact, together with compactness to show that \(T\) has a Vaughtian pair.
Note that for each \(\bar{b}\) either \(\psi(\mcM, \bar{b})\) is infinite or it is co-infinite. 
One of these cases must happen for arbitrarily large \(n\).  % 10-1 in M?
Assume without loos of generality that \(\psi(\mcM, \bar{b})\) is co-infinite and arbitrarily large. 
We will represent model pairs as in the previous section with an additional predicate \(U\) defining an elementary submodel. 
We will show that the following set of formulae is satisfiable: 
\(\E x (\neg U(x))\), \(U(\bar{w})\), \(\{\theta_{\psi, \bar{w}, n}\}_{n\in \N}\), \(\psi(\bar{v}, \bar{w}) \to U(\bar{v})\). 
% Possible Clarification: We took the \(\psi(\mcM, \bar{n})\) co-infinite so we could have a proper elementary submodel. Elaborate more on this. 
When taking finite subsets of these formulae, it suffices to take \(n\) sufficiently large and let \(\bar{w}\) be the \(\bar{b}\) which we know exists.
In this model, \(\{\bar{v}\mid\psi(\bar{w}, \bar{v})\}\) defines an infinite subset, for which \(U(\bar{v})\) holds, in other words, a Vaughtian pair. % Explain more

With these past few lemmata we can conclude that any theory which lack Vaughtian pairs and is \omst has a strongly minimal formula with parameters from a countable prime model. 
We will develop the theory of dimensions of elementary extensions and see that any two extensions of cardinality \(\kappa > \aleph_0\) will have dimension \(\kappa\) over the prime model.
From this fact, we will be able to show they are isomorphic, providing us, finally, with \(\kappa\) categoricity and completing the proof of Morley's categoricity theorem. 
\end{proof}

\subsection{Algebraic Closure and Dimension}

\begin{definition}\label{definition_algebraic_closure}
Given a model \(\mcM\) and an \(A \subseteq M\), we define the algebraic closure of \(A\), denoted \(\acl(A)\) to be all elements of \(M\) which are in a finite set definable by an \(\mcL_A\)-formula. 
(Note that by quantifier elimination over algebraically closed fields, this notion of ``algebraic closure'' agrees with the familiar one.)
\end{definition}

The algebraic closure has the nice properties that \(\acl(\acl(A)) = \acl(A)\), that \(A \subseteq B \implies \acl(A) \subseteq \acl(B)\) and that if \(a \in \acl(A)\) then there is a finite subset \(A_0 \subseteq A\) such that \(a \in \acl(A_0)\).
%This almost gives us that algebraic closure is a pregeometry. % Definition?
We would like the exchange property to be true, namely that if \(a, b \notin \acl(A), a \in \acl(A \cup \{b\})\) then \(b \in \acl(A \cup \{a\})\) 
This is only true when we take \(A\) to be a subset of some strongly minimal set.

\begin{theorem}\label{theorem_exchange}
Let \(S\) be a strongly minimal set. If \(A \subseteq S, a, b \in S\) and \(a, b \notin \acl(A)\) but \(a \in \acl(A \cup \{b\})\) then \(b \in \acl(A \cup \{a\})\) 
\end{theorem}

% Possible Clarification: Limiting \acl to a set D

\begin{proof}
% Possible Improvement: Better presentation/intuition including pairs definable by \phi(x, y)
As \(a \in \acl(A \cup \{b\})\), we have \(\mcM \models \phi(a, b)\) for some \(\mcL_A\)-formula 
% Possible Clarification: Make sure notation of \mcL_A is familiar/defined
\(\phi\) where \(\{x \in S \mid \phi(x, b)\}\) contains \(n\) elements. 
Consider the set defined by \(\psi(y)\), where \(\psi(y)\) asserts that \(\{x \in S \mid \phi(x, y)\}\) contains exactly \(n\) elements. 
% Book mentions \psi(\mcM) is cofinite, why?
We would very much like for \(X = \{y \in S \mid \psi(y) \land \phi(a, y)\}\) to be finite, making \(b \in \acl(A \cup \{a\})\). 
We will show this must be the case by contradiction.
If this fails and \(X\) is infinite, then \(X\) is cofinite. 
Specifically, \(\{y \in S \mid \neg(\psi(y) \land \phi(a, y))\}\) contains \(m\) elements.  
We let \(\theta(x)\) assert that \(\{y \in S \mid \neg(\psi(y) \land \phi(x, y))\}\) contains exactly \(m\) elements.
\(\theta\) also defines a cofinite set, as otherwise \(a \in \acl(A)\).   
Let \(a_1, \ldots, a_{n+1}\) be such that for each \(i\), \(\theta(a_i)\) holds.
As \(\theta(a_i)\) holds, each set \(\{y \in S \mid \psi(y) \land \phi(a_i, y)\}\) is cofinite, as is their intersection. 
For any element, \(b'\) in the intersection, we have \(\psi(b')\) and \(a_i \in \{x \in S \mid \phi(x, b')\}\) for each \(a_i\) by construction.
This is a contradiction as \(\psi(b')\) asserts there are only \(n\) such elements.  
\end{proof}

\begin{definition}\label{definition_independence}
As above let \(D\) be a minimal set. \(A \subseteq D\) is independent if for all \(a \in A\), \(a \notin \acl(A \setminus \{a\})\). 
% Possible Addition: Define ``independent over''. \(A \subseteq D\) is independent over \(C \subseteq D\) if, for all \(a \in A\), \(a \notin \acl(C \cup (A \setminus \{a\}))\). 
\(B\) is a basis for \(A\) when \(\acl(A) = \acl(B)\) and \(B\) is independent.
We will show that all bases of a set \(A\)  have the same cardinality, which we will call the dimension of \(A\).
\end{definition}

\begin{lemma}\label{lemma_dimension}
Given two disjoint independent sets, \(S, T\), 
%whose union is also independent?
 if \(S \cup \{s\}\) is independent, there is an element \(t \in T\) such that \((S \cup \{s\}) \cup (T \setminus \{t\})\) is independent and has the same algebraic closure as \(S \cup T\). 
\end{lemma}

\begin{proof}
Let \(T_0 \subseteq T\) be of the smallest cardinality such that \(s \in \acl(S \cup T_0)\). 
Clearly, \(T_0\) is non-empty, so choose \(t \in T_0\). 
\(s \in \acl(S \cup T_0)\) and by exchange \(t \in \acl(S \cup \{s\} \cup T_0 \setminus \{t\}) \subseteq \acl(S \cup \{s\} \cup T \setminus \{t\})\).
We can conclude \(\acl(S \cup \{s\} \cup T \setminus \{t\}) = \acl(S \cup T)\) as the former contains \(S \cup T\) and is algebraically closed and \(s \in \acl(S \cup T)\). 
It suffices to show \(S \cup \{s\} \cup T \setminus \{t\}\) is independent. 
We already know that \(S \cup T\) and therefore \(S \cup T \setminus \{t\}\) are independent. 
It suffices to show (by exchange) that \(s \notin \acl(S \cup T \setminus \{t\})\).
If this were the case, by exchange we would have \(t \in \acl(S \cup T \setminus \{t\})\) as that set is equal to \(\acl(S \cup \{s\} \cup T \setminus\{t\})\).
But this would contradict the independence of \(S \cup T\). 
\end{proof}

\begin{theorem}\label{theorem_dimension}
The dimension of a set (which is a subset of a strongly minimal set) is well defined.
\end{theorem}

\begin{proof}
To prove the uniqueness of dimension, it suffices to show that if \(A\) and \(B\) are bases for \(|C|\), then \(|A| \leq |B|\). 
The first case we show is when \(|B|\) is finite, which we will show by contradiction.  
Let \(S_0 = \emptyset\) and \(T_0 = A\). We iteratively expand \(S_i\) by elements of \(B = \{b_1, \ldots, b_n\}\) and remove elements of \(T_i\) preserving the algebraic closure of their union. 
Ultimately, we see that \(\acl(A) = \acl(S_i \cup T_i) = \acl(B \cup (A \setminus \{a_1, \ldots, a_n\})) = \acl(C)\)
If \(A \setminus \{a_1, \ldots, a_n\}\) is non-empty and contains some element \(a\), then \(a \notin \acl(B)\) as \(B \cup (A \setminus \{a_1, \ldots, a_n\})\) is independent. 
But \(a \in \acl(A) = \acl(C)\) so \(\acl(B)\) cannot equal \(\acl(C)\) and cannot be a basis. 

In the case where \(B\) is infinite, \(|B| = \kappa\), we note that there are \(\kappa\) many formula with parameters from \(B\) and at most \(\kappa\) many elements of \(\acl(B) = \acl(C) \supset C\). 
It is impossible to take mare than \(\kappa\) many elements of \(C\), so there cannot be a subset \(A\) of \(C\) with \(|A| > |B|\) so there cannot be such a basis. 
\end{proof}

\begin{theorem}\label{partial_elementary_bijection}
Let \(\mcM, \mcN_1, \mcN_1 \models T\) and \(\mcM \prec \mcN_1, \mcM \prec \mcN_2\) and \(\phi(v)\) be a strongly minimal formula with parameters from \(M\).
If \(\phi(\mcN_1)\) has the same dimension as \(\phi(\mcN_2)\), then there is a partial elementary map \(f: \phi(\mcN_1) \to \phi(\mcN_2)\) which is a bijection. 
\end{theorem}

\begin{proof}
Let \(B_1\) be a basis for \(\phi(\mcN_1)\) and \(B_2\) be a basis for \(\phi(\mcN_2)\).
As \(|B_1| = |B_2|\), we have a bijection \(f: B_1 \to B_2\), which we claim is partial elementary. 

% check this
Otherwise, for some \(\psi\) an \(\mcL_\mcM\)-formula and \(\bar{a} \in B_1\) we have \(\mcN_1 \models \psi(\bar{a})\) and \(\mcN_2 \not\models \psi(f(\bar{a}))\). 

% We show that this doesn't happen by induction on length of \(\bar{a}\).
Begin with the case \(\mcN_1 \models \psi(a)\) and \(\mcN_2 \not \models \psi(f(a))\). 
\(a\) is not in any finite definable subset as \(B_1\) is independent and \(a \notin \acl(B_1 \setminus\{a\})\). 
So \(\mcN_1 \models |\{x \mid \phi \land \neg \psi(x)\}| = n\) so \(\mcM \models |\{x \mid \phi \land \neg \psi(x)\}| = n\)
and \(\mcN_2 \models |\{x \mid \phi \land \neg \psi(x)\}| = n\).
\(f(a)\) is not in any finite definable subset as \(B_2\) is independent and \(f(a) \notin \acl(B_2 \setminus\{f(a)\})\). 
So \(\mcN_2 \models \psi(f(a)\) as desired. 

This argument easily generalizes to all \(\bar{a}\). 

Now that we know \(f\) is partial elementary, we consider extensions of \(f\) which are partial elementary. 
By Zorn's Lemma, it suffices to show that any partial elementary \(g\) extending \(f\) which doesn't have all of \(\mcN_1\) as its domain is not maximal (applying this to its inverse tells us it must be surjective as well).
Let \(b \notin \text{dom}(g)\). \(b\) is algebraic over \(\text{dom}(g)\). %why
So, it must be that the type of \(b\) over \(\text{dom}(g)\) is isolated by some \(\phi(v, \bar{d})\).
As \(g\) is partial elementary, \(\phi(v, g(\bar{d}))\) holds for some \(c \in \phi(\mcN_1)\).  % something about still isolating the type?
We must have \(tp(b/\text{dom}(g)) = tp (c/\text{rng}(g))\) so \(g \cup \{(b, c)\}\) must be partial elementary as desired. 

Thus, our maximal element guarunteed by Zorn's Lemma is a bijective partial elementary map between \(\phi(\mcN_1)\) and  \(\phi(\mcN_2)\)
\end{proof}

\subsection{Proof of Morley's Categoricity Theorem}

We can now present a proof of Morley's Categoricity Theorem, Theorem \ref{theorem_morleys_categoricity}.

\begin{proof}
In the previous sections we have succeeded in showing theories categorical in any uncountable cardinal are \omst and lack Vaughtian pairs. 
We now show the converse: two models \(\mcM, \mcN\)  of a complete \omst theory, \(T\), in a countable language lacking Vaughtian pairs we can show \(\mcM \isom \mcN\). 
As \(T\) is \omst it has a prime model, \(\mcM_0\), in which we have a minimal formula \(\phi\) (again as \(T\) is \(\omega\)-stable).
Moreover, as \(T\) has no Vaughtian pairs, \(\phi\) is strongly minimal. 
We begin by constructing a partial elementary map \(f:\phi(\mcM) \to \phi(\mcN)\) which is a bijection, which exists as per Theorem \ref{partial_elementary_bijection}.
Both \(\phi(\mcM), \phi(\mcN)\) have cardinality \(\kappa\) and therefore dimension \(\kappa\). 
As \(\phi(\mcM)\) is infinite and definable and \(T\) has no Vaughtian pairs and is \(\omega\)-stable, \(\mcM\) is prime over \(\phi(\mcM)\).
We can extend \(f\) to an \(f'\) which is partial elementary and has domain \(\mcM\), \(\mcM\) is prime over \(\phi(\mcM)\).
The range of \(f'\) is an elementary submodel of \(\mcN\) (as it's domain is isomorphic to its range) containing \(\phi(\mcN)\). 
If the range of \(f'\) isn't all of \(\mcN\), then \((\mcN, f'(\mcM))\) forms a vaughtian pair (\(\phi(\mcN)\) is infinite and includes no element of \(\mcN \setminus f'(\mcM)\)).  
So \(f'\) is injective (as it is partial elementary) and surjective (as we have no Vaughtian pairs) and is our desired isomorphism. 
\end{proof}

% Possible Addition: general review of proof.
