At this point we've made good progress towards the proof of Morley's Categoricity theorem.
It suffices to show that uncountable categoricity (for any uncountable cardinal) is equivalent to \(\omega\)-stability and lacking Vaughtian pairs.
As this property doesn't depend on the uncountable cardinality, this suffices. 

We've already shown that \(\omega\)-stability and lacking Vaughtian pairs are necessary for uncountable categoricity.
To show these conditions are also sufficient we will define a notion of ``dimension'' for models of such theories (more specifically for their minimal subsets).
If two models of \(T\) have minimal subsets of the same dimension defined by the same \(\phi\) we will be able to construct an isomorphism between them. 
This will always be the case for \(T\) \omst and lacking Vaughtian pairs. 
This will complete the proof. 

\subsection{Strong Minimality and Vaughtian Pairs}

Consider a theory which is \omst and has no Vaughtian-pairs. 
As it is \omst it has a prime model (Theorem \ref{thm_omst_prime}).
By \(\omega\)-stability, that prime model has a minimal formula (Lemma \ref{lemma_minimal_omst}). 
For our proof of Morley's categoricity theorem it will be important that this minimal formula is strongly minimal, so that we can use the dimension of that set to construct an isomorphism between elementary extensions of the prime model  as described above. 
A theory lacking Vaughtian pairs will have the property that minimal formulae are strongly minimal. 

\begin{theorem}\label{theorem_minimal_vaughtian_pair}
If \(T\) has no Vaughtian pairs and \(\phi\) is a minimal formula for \(\mcM \models T\) then \(\phi\) is strongly-minimal. 
\end{theorem}

\begin{proof}
We begin by proving the following claim: Let \(T\) be a theory with no Vaughtian pairs, \(\mcM \models T\), and \(\phi(\bar{v}, \bar{w})\) an \(\mcL\)-formula.
There exists an \(n\) such that if \(\bar{a} \in M\) and \(|\phi(\mcM, \bar{a})| > n\) then \(|\phi(\mcM, \bar{a})|\) is infinite. 

We will prove this by contradiction. 
If this claim is false, for all \(n\) there is an \(\bar{a}_n \in M\) such that \(|\phi(\mcM, \bar{a}_n)| > n\). 
We will use this fact to show that, by compactness, we can find a Vaughtian pair of models of \(T\).
We add constant symbols to our language for \(\bar{b}\) and we will present a finitely satisfiable theory, \(\Gamma\), in \(\mcL^U\) asserting that \((\mcN', \mcM')\) is a Vaughtian pair with infinite definable subset defined by \(\phi(\bar{v}, \bar{b})\). 
Note that we've demonstrated the construction of such a theory in Theorem \ref{theorem_countable_vaughtian_pairs}.

A finite subset of \(\Gamma\) will assert that \(\phi(\mcM', \bar{b}) = \phi(\mcN', \bar{b})\) and both have size at least \(n\). 
We let \(\mcM' = \mcM, \mcN'\) be an arbitrary proper elementary extension of \(\mcM\) and \(\bar{b} = \bar{a}_n\). 
\(\bar{b} = \bar{a}_n\) gives us that \(\phi(\mcM', \bar{b}), \phi(\mcN', \bar{b})\) both have size at least \(n\). 
As \(\phi(\mcM, \bar{a}_n)\) is finite, \(\mcM \models |\phi(\mcM, \bar{a}_n)| = m\) for some \(m\), and therefore \(\mcN' \models |\phi(\mcN', \bar{a}_n)| = m\) as \(\mcM \prec \mcN'\).
This suffices to prove the claim. 

Let \(\phi\) be a minimal formula for \(\mcM \models T\) and \(\mcM \prec \mcN\).
We will show that, for any \(\psi(\bar{v}, \bar{a})\) with \(\bar{a} \in M\) that \(\phi(\bar{v}) \land \psi(\bar{v}, \bar{a})\) defines an infinite or coinfinite subset of \(\phi(\mcN)\) but not both. 
Let \(n\) be the one from our claim above given \(\mcM\) and \(\psi\). 
We know that \(\mcM \models \A \bar{w} \, \neg(\{\bar{v} \mid \phi(\bar{v}) \land \psi(\bar{v}, \bar{w})\} > n \land \{\bar{v} \mid \phi(\bar{v}) \land \neg\psi(\bar{v}, \bar{w})\} > n)\)
This statement remains true in any elementary extension of \(\mcM\), specifically in \(\mcN\), that is to say \(\psi(\bar{v}, \bar{a})\) doesn't define an infinite and coinfinite subset of \(\phi(\mcN)\).
\end{proof}

With this theorem, Theorem \ref{thm_omst_prime} and Lemma \ref{lemma_minimal_omst}, we can conclude that any theory which lacks Vaughtian pairs and is \omst has a strongly minimal formula with parameters from a countable prime model. 
We will develop the theory of dimensions of elementary extensions and see that any two extensions of cardinality \(\kappa > \aleph_0\) will have a definable subset of dimension \(\kappa\) defined by this strongly minimal formula. 
From this fact, we will be able to show these arbitrary models of the same uncountable cardinality are isomorphic, providing us, finally, with \(\kappa\) categoricity and completing the proof of Morley's categoricity theorem. 

\subsection{Algebraic Closure and Dimension}

\begin{definition}\label{definition_algebraic_closure}
Given a model \(\mcM\) and an \(A \subseteq M\), we define the algebraic closure of \(A\), denoted \(\acl(A)\) to be all elements of \(M\) which are in a finite set definable by an \(\mcL_A\)-formula. 
(Note that by quantifier elimination over algebraically closed fields, this notion of ``algebraic closure'' agrees with the familiar one in the case of algebraically closed fields.)
\end{definition}

The algebraic closure has the nice properties that \(\acl(\acl(A)) = \acl(A)\), that \(A \subseteq B \implies \acl(A) \subseteq \acl(B)\) and that if \(a \in \acl(A)\) then there is a finite subset \(A_0 \subseteq A\) such that \(a \in \acl(A_0)\).
We would like the exchange property to be true, namely that if \(a, b \notin \acl(A), a \in \acl(A \cup \{b\})\) then \(b \in \acl(A \cup \{a\})\) 
This is only true when we take \(A\) to be a subset of some strongly minimal set.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This one is confusing.
\begin{theorem}\label{theorem_exchange}
Let \(S\) be a strongly minimal set. If \(A \subseteq S, a, b \in S\) and \(a, b \notin \acl(A)\) but \(a \in \acl(A \cup \{b\})\) then \(b \in \acl(A \cup \{a\})\) 
\end{theorem}

\begin{proof}
As \(a \in \acl(A \cup \{b\})\), we have \(\mcM \models \phi(a, b)\) for some \(\mcL_A\)-formula 
\(\phi\) where \(\{x \in S \mid \phi(x, b)\}\) contains \(n\) elements. 
Consider the set defined by \(\psi(y)\), where \(\psi(y)\) asserts that \(\{x \in S \mid \phi(x, y)\}\) contains exactly \(n\) elements. 
% Book mentions \psi(\mcM) is cofinite, why?
We would very much like for \(X = \{y \in S \mid \psi(y) \land \phi(a, y)\}\) to be finite, making \(b \in \acl(A \cup \{a\})\). 
We will show this must be the case by contradiction.
If this fails and \(X\) is infinite, then \(X\) is cofinite. 
Specifically, \(\{y \in S \mid \neg(\psi(y) \land \phi(a, y))\}\) contains \(m\) elements.  
We let \(\theta(x)\) assert that \(\{y \in S \mid \neg(\psi(y) \land \phi(x, y))\}\) contains exactly \(m\) elements.
\(\theta\) also defines a cofinite set, as otherwise \(a \in \acl(A)\).   
Let \(a_1, \ldots, a_{n+1}\) be such that for each \(i\), \(\theta(a_i)\) holds.
As \(\theta(a_i)\) holds, each set \(\{y \in S \mid \psi(y) \land \phi(a_i, y)\}\) is cofinite, as is their intersection. 
For any element, \(b'\) in the intersection, we have \(\psi(b')\) and \(a_i \in \{x \in S \mid \phi(x, b')\}\) for each \(a_i\) by construction.
This is a contradiction as \(\psi(b')\) asserts there are only \(n\) such elements.  
\end{proof}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{definition}\label{definition_independence}
As above let \(D\) be a minimal set. \(A \subseteq D\) is independent if for all \(a \in A\), \(a \notin \acl(A \setminus \{a\})\). 
\(B\) is a basis for \(A\) when \(\acl(A) = \acl(B)\) and \(B\) is independent.
We will show that all bases of a set \(A\)  have the same cardinality, which we will call the dimension of \(A\).
\end{definition}

\begin{lemma}\label{lemma_dimension}
Given two disjoint sets, \(S, T\), such that \(S \cup T\) is independent, and \(s \in \acl(S \cup T)\), if \(S \cup \{s\}\) is independent, there is an element \(t \in T\) such that \((S \cup \{s\}) \cup (T \setminus \{t\})\) is independent and has the same algebraic closure as \(S \cup T\). 
\end{lemma}

\begin{proof}
Let \(T_0 \subseteq T\) be of the smallest cardinality such that \(s \in \acl(S \cup T_0)\). 
As \(\acl(S \cup T) \ni s\) there must be such a \(T_0\).
Clearly, \(T_0\) is non-empty as \(S \cup \{s\}\) is independent.
Let \(t \in T_0\) be arbitrary. 
Using exchange, since \(s \in \acl(S \cup T_0)\) we see that \(t \in \acl((S \cup \{s\}) \cup (T_0 \setminus \{t\})) \subseteq \acl((S \cup \{s\}) \cup (T \setminus \{t\}))\).

First, we show \(\acl((S \cup \{s\}) \cup (T \setminus \{t\})) = \acl(S \cup T)\).
By choice of \(s\), \((S \cup \{s\}) \cup (T \setminus \{t\}) \subseteq \acl(S \cup T)\) which implies that \(\acl(S \cup \{s\} \cup T \setminus \{t\}) \subseteq \acl(\acl(S \cup T)) = \acl(S \cup T)\).
Similarly, in the other direction, it suffices to note that \(t \in \acl((S \cup \{s\}) \cup (T \setminus \{t\}))\).

We now show that \((S \cup \{s\}) \cup (T \setminus \{t\})\) is independent. 
We already know that \(S \cup T\) and therefore \(S \cup T \setminus \{t\}\) are independent. 
It suffices to show that \(s \notin \acl(S \cup (T \setminus \{t\}))\).
We seek a contradiction. 
If it were true that \(s \in \acl(S \cup T \setminus \{t\})\) then  \(t \in \acl(S \cup (T \setminus \{t\})) = \acl((S \cup \{s\}) \cup (T \setminus\{t\}))\).
But this would contradict the independence of \(S \cup T\). 
\((S \cup \{s\}) \cup (T \setminus \{t\})\) is thus independent. 
\end{proof}

\begin{theorem}\label{theorem_dimension}
The dimension of a set (which is a subset of a strongly minimal set) is well defined.
\end{theorem}

\begin{proof}
To prove the uniqueness of dimension, it suffices to show that if \(A\) and \(B\) are bases for \(|C|\), then \(|A| \leq |B|\). 
The first case we show is when \(|B|\) is finite, which we will show by contradiction.  
Let \(S_0 = \emptyset\) and \(T_0 = A\). We iteratively expand \(S_i\) by elements of \(B = \{b_1, \ldots, b_n\}\) and remove elements of \(T_i\) preserving the algebraic closure of their union. 
Ultimately, we see that \(\acl(A) = \acl(S_i \cup T_i) = \acl(B \cup (A \setminus \{a_1, \ldots, a_n\})) = \acl(C)\)
If \(A \setminus \{a_1, \ldots, a_n\}\) is non-empty and contains some element \(a\), then \(a \notin \acl(B)\) as \(B \cup (A \setminus \{a_1, \ldots, a_n\})\) is independent. 
But \(a \in \acl(A) = \acl(C)\) so \(\acl(B)\) cannot equal \(\acl(C)\) and cannot be a basis. 

In the case where \(B\) is infinite, \(|B| = \kappa\), we note that there are \(\kappa\) many formula with parameters from \(B\) and at most \(\kappa\) many elements of \(\acl(B) = \acl(C) \supseteq C\). 
It is impossible to take mare than \(\kappa\) many elements of \(C\), so there cannot be a subset \(A\) of \(C\) with \(|A| > |B|\) so there cannot be such a basis. 
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This looks bad
\begin{theorem}\label{partial_elementary_bijection}
Let \(\mcM, \mcN_1, \mcN_1 \models T\) and \(\mcM \prec \mcN_1, \mcM \prec \mcN_2\) and \(\phi(v)\) be a strongly minimal formula with parameters from \(M\).
If \(\phi(\mcN_1)\) has the same dimension as \(\phi(\mcN_2)\), then there is a partial elementary map \(f: \phi(\mcN_1) \to \phi(\mcN_2)\) which is a bijection. 
\end{theorem}

\begin{proof}
Let \(B_1\) be a basis for \(\phi(\mcN_1)\) and \(B_2\) be a basis for \(\phi(\mcN_2)\).
As \(|B_1| = |B_2|\), we have a bijection \(f: B_1 \to B_2\), which we claim is partial elementary. 

% check this
Otherwise, for some \(\psi\) an \(\mcL_\mcM\)-formula and \(\bar{a} \in B_1\) we have \(\mcN_1 \models \psi(\bar{a})\) and \(\mcN_2 \not\models \psi(f(\bar{a}))\). 

% We show that this doesn't happen by induction on length of \(\bar{a}\).
Begin with the case \(\mcN_1 \models \psi(a)\) and \(\mcN_2 \not \models \psi(f(a))\). 
\(a\) is not in any finite definable subset as \(B_1\) is independent and \(a \notin \acl(B_1 \setminus\{a\})\). 
So \(\mcN_1 \models |\{x \mid \phi \land \neg \psi(x)\}| = n\) so \(\mcM \models |\{x \mid \phi \land \neg \psi(x)\}| = n\)
and \(\mcN_2 \models |\{x \mid \phi \land \neg \psi(x)\}| = n\).
\(f(a)\) is not in any finite definable subset as \(B_2\) is independent and \(f(a) \notin \acl(B_2 \setminus\{f(a)\})\). 
So \(\mcN_2 \models \psi(f(a)\) as desired. 

This argument easily generalizes to all \(\bar{a}\). 

Now that we know \(f\) is partial elementary, we consider extensions of \(f\) which are partial elementary. 
By Zorn's Lemma, it suffices to show that any partial elementary \(g\) extending \(f\) which doesn't have all of \(\mcN_1\) as its domain is not maximal (applying this to its inverse tells us it must be surjective as well).
Let \(b \notin \text{dom}(g)\). \(b\) is algebraic over \(\text{dom}(g)\). %why
So, it must be that the type of \(b\) over \(\text{dom}(g)\) is isolated by some \(\phi(v, \bar{d})\).
As \(g\) is partial elementary, \(\phi(v, g(\bar{d}))\) holds for some \(c \in \phi(\mcN_1)\).  % something about still isolating the type?
We must have \(tp(b/\text{dom}(g)) = tp (c/\text{rng}(g))\) so \(g \cup \{(b, c)\}\) must be partial elementary as desired. 

Thus, our maximal element guaranteed by Zorn's Lemma is a bijective partial elementary map between \(\phi(\mcN_1)\) and  \(\phi(\mcN_2)\)
\end{proof}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Proof of Morley's Categoricity Theorem}

We can now present a proof of Morley's Categoricity Theorem, Theorem \ref{theorem_morleys_categoricity}.

\begin{proof}
In the previous sections we have succeeded in showing theories categorical in any uncountable cardinal are \omst and lack Vaughtian pairs. 
We now show the converse: two models \(\mcM, \mcN\)  of a complete \omst theory, \(T\), in a countable language lacking Vaughtian pairs we can show \(\mcM \isom \mcN\). 
As \(T\) is \omst it has a prime model, \(\mcM_0\), in which we have a minimal formula \(\phi\) (again as \(T\) is \(\omega\)-stable).
Moreover, as \(T\) has no Vaughtian pairs, \(\phi\) is strongly minimal. 
We begin by constructing a partial elementary map \(f:\phi(\mcM) \to \phi(\mcN)\) which is a bijection, which exists as per Theorem \ref{partial_elementary_bijection}.
Both \(\phi(\mcM), \phi(\mcN)\) have cardinality \(\kappa\) and therefore dimension \(\kappa\). 
As \(\phi(\mcM)\) is infinite and definable and \(T\) has no Vaughtian pairs and is \(\omega\)-stable, \(\mcM\) is prime over \(\phi(\mcM)\).
We can extend \(f\) to an \(f'\) which is partial elementary and has domain \(\mcM\), \(\mcM\) is prime over \(\phi(\mcM)\).
The range of \(f'\) is an elementary submodel of \(\mcN\) (as it's domain is isomorphic to its range) containing \(\phi(\mcN)\). 
If the range of \(f'\) isn't all of \(\mcN\), then \((\mcN, f'(\mcM))\) forms a vaughtian pair (\(\phi(\mcN)\) is infinite and includes no element of \(\mcN \setminus f'(\mcM)\)).  
So \(f'\) is injective (as it is partial elementary) and surjective (as we have no Vaughtian pairs) and is our desired isomorphism. 
\end{proof}
